# School Timetable Pre-Scheduling Instructions

Your task in this step is to create a pre-schedule for all fixed slots before the main timetable generation.  
This pre-schedule defines all non-negotiable (pre-placed, unavailable, scout, and elective) slots for student classes, teachers, and rooms.

---

## Step 1: Generate Empty Schedules
Read the School Period section from the sheet 4: Period, you must NOT include data in Pre-place slots section in this step.
Using this data, generate an empty weekly timetable grid:
**Grid format rules**
- Top-left cell blank
- Ensure the timetable includes exactly 2 header rows, placing all period labels and period times starting from the second column of the first and second rows.
  - Ignore header rows
  - First row = period labels (in original order)
  - Second row = period times aligned under their labels
- After the first two rows, all subsequent rows start with weekdays only, starting from row 3, (Monday, Tuesday, Wednesday, Thursday, Friday)
- If a period name is not a **numeric period** (for example, “Morning Break”, “Lunch”, “Afternoon Break”), Fill that label into every weekday row for that column.
- All other timetable cells must remain empty.
**IMPORTANT**
- Do NOT autopopulate anything else.
- Do not assume period names or times
- Do not translate or modify period names or times
- Treat all text as raw strings
- Skip section titles (e.g., “School period”) and blank rows
Create table **separately** for each entity category:
  - Sheet 6: Student All student classes: use their class_id as table name
  - Sheet 3: Teacher All teachers: use their teacher_id as table name
  - Sheet 5: Room All rooms: use their room_id as table name
Skip any row that is a section title (rows where only the first column has text and other columns are empty) or header (column are defined in previous part).
---

## Step 2: Apply Pre-Placed Slots
Read the Pre-place slots section from the sheet 4: Period.
Each row defines a school activity that must be placed at specific time slots for specific student groups (and sometimes teachers).
For each row in Pre-place slots section:
1. Identify the slot from the periods field
2. Determine the target student classes (and / or teachers) from apply to
3. Place the slot_name into the matching slot(s)
  - Fill the timetable cell for each target class
4. Do not overwrite existing slots
  - If a slot is already filled (except break or no class) → record a conflict instead

Goals for step 2
- Updated class timetables
- Updated teacher and room timetables (if applicable)
- A conflict log sheet for cases where a slot is already occupied
**IMPORTANT**
- Use empty timetable grid from step 1 as base and apply pre-place slot.
- Never change period names or weekday names
- Only assign slots exactly as defined in the sheet
- Treat these slots as fixed and unavailable for future scheduling
---

## Step 3: Assign Scout (ลูกเสือ) Sessions
- Read Sheet 7: Scout (ลูกเสือ).

For each column:
- ลูกเสือ ม.1 (Scout M.1) → Find the corresponding teacher(s) listed under this column.
  - Mark all Scout M.1 slots (as defined in Sheet 4) in their schedules.
- Repeat the same for:
  - ลูกเสือ ม.2 (Scout M.2)
  - ลูกเสือ ม.3 (Scout M.3)

---

## Step 4: Schedule Elective Courses
- Read Sheet 2: Elective (วิชาเลือก).

For each elective subject:
1. Identify the teacher assigned to it.
2. Locate the elective slots (defined in Sheet 4).
3. Schedule the elective course in:
   - The teacher’s schedule
   - The corresponding class’s schedule
   - The room’s schedule
4. Set the value in the assigned slots to 1 to mark the elective course.
5. Ensure all schedules remain conflict-free across teachers, rooms, and classes.

---

## Step 5: Mark Teacher Availability
- Read Sheet 3: Teacher (ครู).

### For Each Internal Teachers:
- Read the `unavailable_slots` column.
- Mark all listed slots as unavailable in their timetable.
- These unavailable slots must also be treated as occupied when checking for overlaps.

### For Each External Teachers:
- Read the `available_slots` column.
- Mark all slots except those listed as unavailable.

---

Goal:  
After completing these steps, you should have a fully populated pre-schedule that includes all fixed slots and unavailabilities, ready for the next phase of automated timetable generation.
